<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Chat con voz y lista de frutas</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(120deg, #f3e5f5 0%, #e1bee7 100%);
    color: #2a1432;
    margin: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
  }
  #chat-box {
    width: 350px;
    height: 350px;
    background: white;
    border-radius: 10px;
    padding: 10px;
    overflow-y: auto;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .lia-message {
    background: #e1bee7;
    padding: 8px;
    border-radius: 10px;
    color: #3d1747;
    max-width: 80%;
    align-self: flex-start;
  }
  .user-message {
    background: #8e24aa;
    color: white;
    padding: 8px;
    border-radius: 10px;
    max-width: 80%;
    align-self: flex-end;
  }
  #user-input {
    width: 280px;
    padding: 8px;
    border-radius: 5px;
    border: 1px solid #ccc;
    font-size: 1em;
  }
  #controls {
    margin-top: 10px;
    display: flex;
    gap: 5px;
  }
  button {
    cursor: pointer;
    border: none;
    background: #8e24aa;
    color: white;
    padding: 8px 12px;
    border-radius: 6px;
    font-weight: 600;
    transition: background 0.3s;
  }
  button:hover {
    background: #6a1b9a;
  }
</style>
</head>
<body>

<h1>Chat con voz y texto</h1>

<div id="chat-box"></div>

<div id="controls">
  <input id="user-input" type="text" placeholder="Escrib√≠ un mensaje..." autocomplete="off" />
  <button id="send-btn">Enviar</button>
  <button id="voice-btn">üé§ Hablar</button>
</div>

<script>
  const chatBox = document.getElementById('chat-box');
  const userInput = document.getElementById('user-input');
  const sendBtn = document.getElementById('send-btn');
  const voiceBtn = document.getElementById('voice-btn');

  function agregarMensaje(texto, tipo) {
    const div = document.createElement('div');
    div.className = tipo === 'user' ? 'user-message' : 'lia-message';

    if (tipo === 'lia' && texto === 'LISTA_FRUTAS') {
      div.innerHTML = `
        <b>Lista de frutas:</b>
        <ul>
          <li>Manzana üçé</li>
          <li>Banana üçå</li>
          <li>Naranja üçä</li>
          <li>Frutilla üçì</li>
          <li>Mango ü•≠</li>
          <li>Uvas üçá</li>
        </ul>
      `;
    } else {
      div.textContent = texto;
    }

    chatBox.appendChild(div);
    chatBox.scrollTop = chatBox.scrollHeight;
  }

  function responder(mensajeUsuario) {
    const msg = mensajeUsuario.toLowerCase().trim();
    if (msg.includes('lista de frutas') || msg.includes('frutas')) {
      return 'LISTA_FRUTAS';
    }
    return "No entend√≠ muy bien... üòÖ";
  }

  function enviarMensaje() {
    const texto = userInput.value.trim();
    if (!texto) return;
    agregarMensaje(texto, 'user');
    userInput.value = '';

    setTimeout(() => {
      const respuesta = responder(texto);
      agregarMensaje(respuesta, 'lia');
    }, 500);
  }

  sendBtn.addEventListener('click', enviarMensaje);
  userInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      enviarMensaje();
    }
  });

  // Reconocimiento de voz
  let reconocimiento;
  if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    reconocimiento = new SpeechRecognition();
    reconocimiento.lang = 'es-AR';
    reconocimiento.continuous = false;
    reconocimiento.interimResults = false;

    reconocimiento.onstart = () => {
      voiceBtn.textContent = 'üéôÔ∏è Escuchando...';
      voiceBtn.disabled = true;
    };

    reconocimiento.onerror = (event) => {
      agregarMensaje(`üé§ Error de voz: ${event.error}`, 'lia');
      voiceBtn.textContent = 'üé§ Hablar';
      voiceBtn.disabled = false;
    };

    reconocimiento.onend = () => {
      voiceBtn.textContent = 'üé§ Hablar';
      voiceBtn.disabled = false;
    };

    reconocimiento.onresult = (event) => {
      const textoVoz = event.results[0][0].transcript;
      agregarMensaje(textoVoz, 'user');
      const respuesta = responder(textoVoz);
      agregarMensaje(respuesta, 'lia');
    };

    voiceBtn.addEventListener('click', () => {
      reconocimiento.start();
    });
  } else {
    voiceBtn.disabled = true;
    voiceBtn.textContent = 'üé§ No soportado';
  }
</script>

</body>
</html>
