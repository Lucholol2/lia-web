<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Chat Mejorado con Comandos</title>
<style>
  body,input,button{font-family:sans-serif}
  body {
    margin:20px;
    background:linear-gradient(120deg,#f3e5f5 0%,#e1bee7 100%);
    color:#2a1432;
    display:flex;
    flex-direction:column;
    align-items:center;
    min-height:100vh;
    padding:5px 2px;
    user-select:none;
    -webkit-font-smoothing:antialiased;
  }
  h1 {
    margin-bottom:7px;
    font-size:1em;
    color:#8e24aa;
    font-weight:700;
  }
  .subtitulo {
    color:#9c27b0;
    font-size:.72em;
    margin:-3px 0 10px;
    font-weight:500;
    opacity:.82;
  }
  #chat-box {
    width:100%;
    max-width:420px;
    height:60vh;
    background:#fff;
    color:#000;
    border-radius:10px;
    overflow-y:auto;
    padding:10px;
    display:flex;
    flex-direction:column;
    gap:10px;
    font-size:.92em;
  }
  .user,.lia,.typing {
    margin:6px;
    padding:10px;
    border-radius:12px;
    max-width:75vw;
    word-break:break-word;
    line-height:1.3;
  }
  .user {
    background:#8e24aa;
    color:#fff;
    align-self:flex-end;
    font-weight:600;
    user-select: text !important;
  }
  .lia {
    background:#e1bee7;
    color:#222;
    align-self:flex-start;
    user-select: text !important;
  }
  .typing {
    background:#d1c4e9;
    color:#4a256b;
    font-style:italic;
    align-self:flex-start;
  }
  #inputArea {
    margin-top:8px;
    display:flex;
    width:100%;
    max-width:420px;
    gap:8px;
    padding:5px 4px 4px;
    border-top:1px solid #ede7f6;
    background:#fff;
    border-radius:10px;
  }
  #user-input {
    flex-grow:1;
    padding:7px 10px;
    border:2px solid #8e24aa;
    border-radius:14px;
    font-size:.87em;
    outline:none;
    background:#f8eaf6;
    color:#4a256b;
    font-family:inherit;
  }
  #user-input:focus {
    background:#f3e5f5;
    border-color:#8e24aa;
    color:#3d1747;
  }
  button {
    background:linear-gradient(120deg,#8e24aa 60%,#6a1b9a 100%);
    color:#fff;
    border:none;
    border-radius:14px;
    padding:0 12px;
    height:35px;
    cursor:pointer;
    box-shadow:0 1px 5px #ce93d8;
    transition:background .19s,box-shadow .16s;
    user-select:none;
    font-weight:600;
    font-size:.9em;
  }
  button:hover,button:focus {
    background:linear-gradient(120deg,#6a1b9a 80%,#8e24aa 100%);
    box-shadow:0 1.2px 7px #8e24aa5f;
    outline:none;
  }
  a {
    color:#6a1b9a;
    text-decoration:underline;
  }
  a:hover,a:focus {
    color:#8e24aa;
  }
  #errors-container {
    white-space:pre-wrap;
    margin-top:10px;
    background:#fdecea;
    color:#b00020;
    padding:10px;
    border-radius:8px;
    max-width:420px;
    font-family:monospace;
    font-size:.9em;
    display:none;
  }
  #clear-btn {
    background:linear-gradient(120deg,#d32f2f 60%,#b71c1c 100%);
    margin-left:8px;
    border-radius:14px;
  }
  #clear-btn:hover,#clear-btn:focus {
    background:linear-gradient(120deg,#b71c1c 80%,#d32f2f 100%);
    box-shadow:0 1.2px 7px #8e24aa5f;
    outline:none;
  }
  #comandos-lista {
    margin-top:20px;
    max-width:420px;
    background:#fafafa;
    border:1px solid #ddd;
    border-radius:10px;
    padding:15px 20px;
    font-size:0.9em;
    color:#333;
    line-height:1.5;
    user-select:text;
  }
  #comandos-lista h2 {
    color:#8e24aa;
    margin-bottom:10px;
  }
  @media(max-width:330px) {
    #chat-box {
      height:50vh;
    }
    #user-input {
      font-size:.8em;
    }
  }
</style>
</head>
<body>

<h1>Hola, pap√°! ¬øQuer√©s charlar conmigo? üòÑ</h1>
<div class="subtitulo">Prob√° con "buscar algo" o salud√° üòé</div>

<div id="chat-box"></div>

<div id="inputArea">
  <input type="text" id="user-input" placeholder="Escrib√≠ algo..." autocomplete="off" />
  <button id="send-btn" title="Enviar">Enviar</button>
  <button id="show-errors-btn" title="Ver mensajes no entendidos">Ver errores</button>
  <button id="clear-btn" title="Limpiar chat">Limpiar</button>
</div>

<div id="errors-container"></div>

<!-- Lista de comandos -->
<div id="comandos-lista">
  <h2>¬øQu√© puedo hacer?</h2>
  <ul>
    <li><b>Saludos:</b> Escrib√≠ "hola", "buenas", "hey", etc. para saludar.</li>
    <li><b>B√∫squedas en Google:</b> Escrib√≠ frases como "buscar f√∫tbol", "busca clima Buenos Aires", "buscar en google recetas".</li>
    <li><b>Ver errores:</b> Escrib√≠ "ver errores" o "mostrar errores" para ver mensajes que no entend√≠.</li>
    <li><b>Limpiar chat:</b> Usa el bot√≥n "Limpiar" para borrar todo el chat y el historial.</li>
  </ul>
</div>

<script>
  const chatBox=document.getElementById('chat-box'),
    userInput=document.getElementById('user-input'),
    sendBtn=document.getElementById('send-btn'),
    showErrorsBtn=document.getElementById('show-errors-btn'),
    clearBtn=document.getElementById('clear-btn'),
    errorsContainer=document.getElementById('errors-container');

  let erroresNoEntendidos=[],typingTimeout=null;

  function cargarHistorial(){
    const historial=localStorage.getItem('chatHistorial');
    if(historial){
      const mensajes=JSON.parse(historial);
      mensajes.forEach(m=>agregarMensaje(m.texto,m.clase,false));
    }
  }
  function guardarHistorial(){
    const mensajes=[];
    chatBox.querySelectorAll('div.user,div.lia').forEach(div=>{
      mensajes.push({texto:div.innerHTML,clase:div.className});
    });
    localStorage.setItem('chatHistorial',JSON.stringify(mensajes));
  }

  function agregarMensaje(texto,clase,guardar=true){
    const msg=document.createElement('div');
    if(clase==='lia') msg.innerHTML=texto;
    else msg.textContent=texto;
    msg.className=clase;
    chatBox.appendChild(msg);
    chatBox.scrollTop=chatBox.scrollHeight;
    if(guardar) guardarHistorial();
  }

  function mostrarTyping(callback){
    const typingMsg=document.createElement('div');
    typingMsg.className='typing';
    typingMsg.textContent='lia est√° escribiendo...';
    chatBox.appendChild(typingMsg);
    chatBox.scrollTop=chatBox.scrollHeight;
    typingTimeout=setTimeout(()=>{
      chatBox.removeChild(typingMsg);
      callback();
    },1200);
  }

  function procesarMensaje(texto){
    const mensaje=texto.toLowerCase().trim();
    const saludos=['hola','buenas','buen d√≠a','buenos d√≠as','buenas tardes','buenas noches','hi','hey','hello'];
    if(saludos.some(s=>mensaje===s))
      return '¬°Hola! üòä ¬øEn qu√© puedo ayudarte hoy?';
    if(mensaje==='ver errores'||mensaje==='mostrar errores'||mensaje==='errores'){
      if(erroresNoEntendidos.length===0) return 'No hay errores para mostrar.';
      else return 'Mensajes no entendidos:\n'+erroresNoEntendidos.join('\n');
    }
    const buscarRegex=/^(buscar|busca|buscar en google)\s+(.+)/i;
    const match=texto.match(buscarRegex);
    if(match){
      const terminoBusqueda=encodeURIComponent(match[2].trim());
      return `<a href="https://www.google.com/search?q=${terminoBusqueda}" target="_blank" rel="noopener noreferrer">Buscar "${match[2].trim()}" en Google üîç</a>`;
    }
    erroresNoEntendidos.push(texto);
    return 'No entend√≠ muy bien... üòÖ';
  }

  function enviarMensaje(){
    const texto=userInput.value.trim();
    if(!texto) return;
    agregarMensaje(texto,'user');
    userInput.value='';
    errorsContainer.style.display='none';
    mostrarTyping(()=>{
      const respuesta=procesarMensaje(texto);
      agregarMensaje(respuesta,'lia');
    });
  }

  sendBtn.addEventListener('click',enviarMensaje);
  userInput.addEventListener('keydown',e=>{if(e.key==='Enter') enviarMensaje();});
  showErrorsBtn.addEventListener('click',()=>{
    if(erroresNoEntendidos.length===0) errorsContainer.textContent='No hay errores para mostrar.';
    else errorsContainer.textContent='Mensajes no entendidos:\n'+erroresNoEntendidos.join('\n');
    errorsContainer.style.display='block';
  });
  clearBtn.addEventListener('click',()=>{
    localStorage.removeItem('chatHistorial');
    erroresNoEntendidos=[];
    chatBox.innerHTML='';
    errorsContainer.style.display='none';
  });

  cargarHistorial();
</script>

</body>
</html>
